(reaction-paths-on-the-free-energy-landscapes-transition-path-sampling)=
# Reaction Paths on the Free Energy Landscapes: Transition Path Sampling

As mentioned in Sec.[sec:kinetics](#sec:kinetics), FEPs can be used to
extract useful information about reaction kinetics, but care must be
taken in presence of complex landscapes. A complementary class of
approaches focuses on determining representative transition pathways by
optimizing geometric or variational principles. Across these families of
methods, algorithms inspired by minimum‐action geometry---such as NEB
and its extensions (Jónsson, Mills, and Jacobsen 1998; Henkelman and
Jónsson 2000; Wang et al. 2016; Ásgeirsson et al. 2021) as well as
finite-temperature string approaches (E, Ren, and Vanden-Eijnden 2002,
2005, 2007) and Onsager--Machlup formulations (Onsager and Machlup 1953;
Adib 2008; Faccioli et al. 2006)---contrast with flux-based kinetic
formalisms such as the Bennett--Chandler theory (Ruiz-Montero, Frenkel,
and Brey 1997; Vanden-Eijnden 2006; Vanden-Eijnden et al. 2010) in that
the former determine representative transition pathways by extremizing
geometric or variational principles, whereas the latter quantify
reaction rates through time-correlation functions and dynamical
recrossing statistics. These geometric and variational approaches
provide valuable insight into likely pathways, but a complete
statistical description of rare events requires sampling full reactive
trajectories, as achieved by Transition Path Sampling (TPS). For a
Markovian dynamics, the probability density of a trajectory
$\{\mathbf{r}\}=(\mathbf{r}_0,\mathbf{r}_1,\dots,\mathbf{r}_t)$ is
$$p[\{\mathbf{r}\}] = \rho(\mathbf{r}_0)\prod_{i=0}^{t-1}p(\mathbf{r}_{i+1}|\mathbf{r}_i),\label{eq:path-prob}$$
where $\rho(\mathbf{r}_0)$ is the equilibrium distribution and
$p(\mathbf{r}_{i+1}|\mathbf{r}_i)$ the conditional propagator (Bolhuis
et al. 2002). The probability that a trajectory initiated in $A$ reaches
$B$ at time $t$ is
$$C(t) = \frac{\langle h_A(\mathbf{r}_0),h_B(\mathbf{r}_t)\rangle}{\langle h_A(\mathbf{r}_0)\rangle}
= \frac{\mathcal{Z}_{AB}(t)}{\mathcal{Z}_A},$$ with
$$\mathcal{Z}_A = \int\mathcal{D}\{\mathbf{x}\}h_A(\mathbf{r}_0)p[\{\mathbf{r}\}]\qquad
\mathcal{Z}_{AB} = \int \mathcal{D}\{\mathbf{r}\} h_A(\mathbf{r}_0)p[\{\mathbf{r}\}]h_B(\mathbf{r}_t),$$
where $\mathcal{Z}_A$ is the probability of a trajectory to start from
$\mathbf{r}_0$, regardless of where it ends at time $t$, and
$\mathcal{Z}_{AB}$ that to start in $r_0$ and end in $r_t$. These
probabilities are expressed in terms of path integrals, effectively
functional integrals over the set of all possible paths (Feynman 1948;
Kleinert 2009; Seifert 2012). The rate constant, for example, follows
from the long-time derivative (Bolhuis et al. 2002),
$$k_{AB} = \lim_{t\to\infty}\frac{d}{dt}\left(\frac{Z_{AB}(t)}{Z_A}\right),$$
and the problem of evaluating the rate $k_{AB}$ reduces to sampling the
path ensemble in the same conceptual way as equilibrium properties are
obtained from the Boltzmann distribution. One can generate trajectories
that sample the biased probability of starting in region $A$ and ending
in region $B$ without recrossing in a straightforward manner. Starting
from one reactive path, new trial trajectories $\{\mathbf{r}'\}$ are
generated by small stochastic modifications and integrated forward and
backward in time, accepting or rejecting the new path $\{\mathbf{r}'\}$
using a Metropolis scheme (Metropolis and Ulam 1949; Kalos and Whitlock
2008; Frenkel and Smit 2023). In the microcanonical ensemble or other
generalized ensembles with extended Hamiltonians, the acceptance
probability becomes remarkably simple (Dellago, Bolhuis, and Geissler
2002) as all reactive proposals are accepted. Quantities like the rate
$k_{AB}$ are not directly accessible as they are computed with a
normalization factor over the path starting in $A$ and ending at any
point. However, TPS provides direct access to the transmission function
$\kappa(t) = k(t)/k_{tst}$ via
$\kappa(t) = \langle \dot h_B(t) \rangle_{AB} / \langle \dot h_B(0) \rangle_{AB}$.
The rate constant can be accessed by supplementing TPS with a US in the
TPE (Dellago, Bolhuis, and Chandler 1999). Sampling the TPE enables a
straightforward computation of the committor function $p_B(\mathbf r)$
(see Sec.[sec:committor](#sec:committor)). With TPS one can easily
identify transition-state configurations by launching short trajectories
from frames along the generated paths and selecting those for which
$p_B\simeq{0.5}$.

Related path-sampling approaches include Transition Interface Sampling
(TIS) (Van Erp, Moroni, and Bolhuis 2003; Van Erp and Bolhuis 2005),
Forward Flux Sampling (FFS) (Allen, Valeriani, and Ten Wolde 2009), and
Markov State Models (MSMs) (Prinz et al. 2011; Chodera and Noé 2014).
TIS introduces a hierarchy of interfaces between $A$ and $B$, estimating
the rate as the product of conditional crossing probabilities and the
initial flux. FFS instead propagates trajectories forward across
interfaces, making it suitable for non-equilibrium or irreversible
systems. MSMs reconstruct long-time kinetics from short unbiased
trajectories by estimating transition probabilities between metastable
states, with rates and committors derived from the transition matrix.
Further refinements include Precision, S-, and Aimless Shooting
(Grünwald, Dellago, and Geissler 2008; Menzl, Singraber, and Dellago
2016; Peters and Trout 2006), and hybrid schemes combining TPS with
metadynamics or replica exchange (Borrero and Dellago 2016; Erp 2007). A
detailed overview is given in (Bolhuis and Swenson 2021).

# References

:::::::::::::::::::::::::::::::::::: {#refs .references .csl-bib-body .hanging-indent entry-spacing="0"}
::: {#ref-adib2008stochastic .csl-entry}
Adib, Artur B. 2008. "Stochastic Actions for Diffusive Dynamics:
Reweighting, Sampling, and Minimization." *J. Phys. Chem. B* 112 (19):
5910--16.
:::

::: {#ref-allen2009forward .csl-entry}
Allen, Rosalind J, Chantal Valeriani, and Pieter Rein Ten Wolde. 2009.
"Forward Flux Sampling for Rare Event Simulations." *J. Phys. Cond.
Mat.* 21 (46): 463102.
:::

::: {#ref-asgeirsson2021nudged .csl-entry}
Ásgeirsson, Vilhjálmur, Benedikt Orri Birgisson, Ragnar Bjornsson, Ute
Becker, Frank Neese, Christoph Riplinger, and Hannes Jónsson. 2021.
"Nudged Elastic Band Method for Molecular Reactions Using
Energy-Weighted Springs Combined with Eigenvector Following." *J. Chem.
Theory Comput.* 17 (8): 4929--45.
:::

::: {#ref-bolhuis2002transition .csl-entry}
Bolhuis, Peter G, David Chandler, Christoph Dellago, and Phillip L
Geissler. 2002. "Transition Path Sampling: Throwing Ropes over Rough
Mountain Passes, in the Dark." *Annu. Rev. Phys. Chem.* 53 (1):
291--318.
:::

::: {#ref-bolhuis2021transition .csl-entry}
Bolhuis, Peter G, and David WH Swenson. 2021. "Transition Path Sampling
as Markov Chain Monte Carlo of Trajectories: Recent Algorithms,
Software, Applications, and Future Outlook." *Adv. Theory Simul.* 4 (4):
2000237.
:::

::: {#ref-borrero2016avoiding .csl-entry}
Borrero, Ernesto E, and Christoph Dellago. 2016. "Avoiding Traps in
Trajectory Space: Metadynamics Enhanced Transition Path Sampling."
*Europhys. J. Special Topics* 225 (8): 1609--20.
:::

::: {#ref-chodera2014markov .csl-entry}
Chodera, John D, and Frank Noé. 2014. "Markov State Models of
Biomolecular Conformational Dynamics." *Curr. Opi. Struct. Bio.* 25:
135--44.
:::

::: {#ref-dellago1999calculation .csl-entry}
Dellago, Christoph, Peter G Bolhuis, and David Chandler. 1999. "On the
Calculation of Reaction Rate Constants in the Transition Path Ensemble."
*J. Chem. Phys.* 110 (14): 6617--25.
:::

::: {#ref-dellago2002transition .csl-entry}
Dellago, Christoph, Peter G Bolhuis, and Phillip L Geissler. 2002.
"Transition Path Sampling." *Adv. Chem. Phys.* 123: 1--78.
:::

::: {#ref-weinan2002string .csl-entry}
E, Weinan, Weiqing Ren, and Eric Vanden-Eijnden. 2002. "String Method
for the Study of Rare Events." *Phys. Rev. B* 66 (5): 052301.
:::

::: {#ref-weinan2005finite .csl-entry}
---------. 2005. "Finite Temperature String Method for the Study of Rare
Events." *J. Phys. Chem. B* 109 (14): 6688--93.
:::

::: {#ref-ren2007simplified .csl-entry}
---------. 2007. "Simplified and Improved String Method for Computing
the Minimum Energy Paths in Barrier-Crossing Events." *J. Chem. Phys.*
126 (16).
:::

::: {#ref-van2007reaction .csl-entry}
Erp, Titus S van. 2007. "Reaction Rate Calculation by Parallel Path
Swapping." *Phys. Rev. Lett.* 98 (26): 268301.
:::

::: {#ref-faccioli2006dominant .csl-entry}
Faccioli, Pietro, Marcello Sega, Francesco Pederiva, and H Orland. 2006.
"Dominant Pathways in Protein Folding." *Phys. Rev. Lett.* 97 (10):
108101.
:::

::: {#ref-feynman1948space .csl-entry}
Feynman, Richard Phillips. 1948. "Space-Time Approach to
Non-Relativistic Quantum Mechanics." *Rev. Mod. Phys.* 20 (2): 367.
:::

::: {#ref-frenkel_understanding_2023 .csl-entry}
Frenkel, Daan, and Berend Smit. 2023. *Understanding Molecular
Simulation*. Elsevier. <https://doi.org/10.1016/C2009-0-63921-0>.
:::

::: {#ref-grunwald2008precision .csl-entry}
Grünwald, Michael, Christoph Dellago, and Phillip L Geissler. 2008.
"Precision Shooting: Sampling Long Transition Pathways." *J. Chem. Phys*
129 (19).
:::

::: {#ref-henkelman2000improved .csl-entry}
Henkelman, Graeme, and Hannes Jónsson. 2000. "Improved Tangent Estimate
in the Nudged Elastic Band Method for Finding Minimum Energy Paths and
Saddle Points." *J. Chem. Phys.* 113 (22): 9978--85.
:::

::: {#ref-jonsson1998nudged .csl-entry}
Jónsson, Hannes, Greg Mills, and Karsten W Jacobsen. 1998. "Nudged
Elastic Band Method for Finding Minimum Energy Paths of Transitions." In
*Classical and Quantum Dynamics in Condensed Phase Simulations*,
385--404. World Scientific.
:::

::: {#ref-kalos2009monte .csl-entry}
Kalos, M. H., and P. A. Whitlock. 2008. *Monte Carlo Methods*. Weinheim,
Germany: Wiley-VCH.
:::

::: {#ref-kleinert2009path .csl-entry}
Kleinert, Hagen. 2009. *Path Integrals in Quantum Mechanics, Statistics,
Polymer Physics, and Financial Markets*. 5th ed. London, U.K.: World
Scientific Publishing Company.
:::

::: {#ref-menzl2016s .csl-entry}
Menzl, Georg, Andreas Singraber, and Christoph Dellago. 2016.
"S-Shooting: A Bennett--Chandler-Like Method for the Computation of Rate
Constants from Committor Trajectories." *Farad. Discuss.* 195: 345--64.
:::

::: {#ref-metropolis1949monte .csl-entry}
Metropolis, Nicholas, and Stanislaw Ulam. 1949. "The Monte Carlo
Method." *J. Am. Stat. Assoc.* 44 (247): 335--41.
:::

::: {#ref-onsager1953fluctuations .csl-entry}
Onsager, Lars, and Stefan Machlup. 1953. "Fluctuations and Irreversible
Processes." *Phys. Rev.* 91 (6): 1505.
:::

::: {#ref-peters2006obtaining .csl-entry}
Peters, Baron, and Bernhardt L Trout. 2006. "Obtaining Reaction
Coordinates by Likelihood Maximization." *J. Chem. Phys.* 125 (5).
:::

::: {#ref-prinz2011markov .csl-entry}
Prinz, Jan-Hendrik, Hao Wu, Marco Sarich, Bettina Keller, Martin Senne,
Martin Held, John D Chodera, Christof Schütte, and Frank Noé. 2011.
"Markov Models of Molecular Kinetics: Generation and Validation." *J.
Chem. Phys.* 134 (17).
:::

::: {#ref-ruiz-montero_efficient_1997 .csl-entry}
Ruiz-Montero, M. J., D. Frenkel, and J. J. Brey. 1997. "Efficient
Schemes to Compute Diffusive Barrier Crossing Rates." *Molecular
Physics* 90 (6): 925--41. <https://doi.org/10.1080/00268979709482677>.
:::

::: {#ref-seifert2012stochastic .csl-entry}
Seifert, Udo. 2012. "Stochastic Thermodynamics, Fluctuation Theorems and
Molecular Machines." *Rep. Prog. Phys.* 75 (12): 126001.
:::

::: {#ref-van2005elaborating .csl-entry}
Van Erp, Titus S, and Peter G Bolhuis. 2005. "Elaborating Transition
Interface Sampling Methods." *J. Comput. Phys.* 205 (1): 157--81.
:::

::: {#ref-van2003novel .csl-entry}
Van Erp, Titus S, Daniele Moroni, and Peter G Bolhuis. 2003. "A Novel
Path Sampling Method for the Calculation of Rate Constants." *J. Chem.
Phys.* 118 (17): 7762--74.
:::

::: {#ref-vanden2006transition .csl-entry}
Vanden-Eijnden, Eric. 2006. "Transition Path Theory." In *Computer
Simulations in Condensed Matter Systems: From Materials to Chemical
Biology Volume 1*, 453--93. Springer.
:::

::: {#ref-vanden2010transition .csl-entry}
Vanden-Eijnden, Eric et al. 2010. "Transition-Path Theory and
Path-Finding Algorithms for the Study of Rare Events." *Annu. Rev. Phys.
Chem.* 61: 391--420.
:::

::: {#ref-wang2016automated .csl-entry}
Wang, Lee-Ping, Robert T McGibbon, Vijay S Pande, and Todd J Martinez.
2016. "Automated Discovery and Refinement of Reactive Molecular Dynamics
Pathways." *J. Chem. Theory Comput.* 12 (2): 638--49.
:::
::::::::::::::::::::::::::::::::::::
